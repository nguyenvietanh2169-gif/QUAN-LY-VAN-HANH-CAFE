<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>CafeFlow ERP</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
</head>

<body class="p-4 max-w-md mx-auto bg-slate-100">

<h1 class="text-xl font-black mb-4 text-center">CafeFlow ERP</h1>

<div class="bg-white p-4 rounded-xl mb-4">
<h2 class="font-bold mb-2">â˜• Menu</h2>
<div id="menu" class="grid grid-cols-2 gap-2"></div>
</div>

<div class="bg-white p-4 rounded-xl">
<h2 class="font-bold mb-2">ğŸ§¾ ÄÆ¡n chá»</h2>
<div id="orders"></div>
</div>

<script>
/* ===== FIREBASE CONFIG ===== */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "YOUR_PROJECT",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

console.log("ğŸ”¥ Firebase connected");

/* ===== SEED DATA (CHáº Y 1 Láº¦N) ===== */
db.ref('products').once('value').then(snap=>{
  if(!snap.exists()){
    console.log("ğŸŒ± Seeding products");
    db.ref('products').set({
      cafe_den:{name:"Cafe Äen",price:25000},
      cafe_sua:{name:"Cafe Sá»¯a",price:30000}
    });
  }
});

/* ===== LOAD MENU ===== */
db.ref('products').on('value', snap=>{
  console.log("ğŸ“¦ Products loaded");
  const menu=document.getElementById('menu');
  menu.innerHTML='';
  snap.forEach(p=>{
    const d=p.val();
    menu.innerHTML+=`
      <button 
        class="bg-slate-200 p-3 rounded-xl font-bold"
        onclick="order('${p.key}')">
        ${d.name}<br>${d.price.toLocaleString()}Ä‘
      </button>`;
  });
});

/* ===== ORDER ===== */
function order(id){
  console.log("ğŸ›’ Order",id);
  db.ref('products/'+id).once('value').then(s=>{
    const p=s.val();
    db.ref('orders').push({
      name:p.name,
      price:p.price,
      status:"pending",
      time:Date.now()
    });
  });
}

/* ===== LOAD ORDERS ===== */
db.ref('orders').on('value', snap=>{
  const box=document.getElementById('orders');
  box.innerHTML='';
  snap.forEach(o=>{
    const d=o.val();
    if(d.status==="pending"){
      box.innerHTML+=`
        <div class="flex justify-between py-1">
          ${d.name}
          <button class="text-indigo-600"
            onclick="done('${o.key}')">Xong</button>
        </div>`;
    }
  });
});

/* ===== COMPLETE ===== */
function done(key){
  console.log("âœ… Done",key);
  db.ref('orders/'+key).update({status:"done"});
}
</script>

</body>
</html>
